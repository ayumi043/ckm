(function(){var e,t=$G("J_title"),i=$G("J_caption"),n=$G("J_autoSizeContent"),o=$G("J_autoSizePage"),a=$G("J_tone"),r=$G("J_preview"),s=function(){e=this,e.init()};s.prototype={init:function(){var r=new UE.ui.ColorPicker({editor:editor}),s=new UE.ui.Popup({editor:editor,content:r});t.checked=-1==editor.queryCommandState("inserttitle"),i.checked=-1==editor.queryCommandState("insertcaption"),e.createTable(t.checked,i.checked),e.setAutoSize(),e.setColor(e.getColor()),domUtils.on(t,"click",e.titleHanler),domUtils.on(i,"click",e.captionHanler),domUtils.on(n,"click",e.autoSizeContentHanler),domUtils.on(o,"click",e.autoSizePageHanler),domUtils.on(a,"click",function(){s.showAnchor(a)}),domUtils.on(document,"mousedown",function(){s.hide()}),r.addListener("pickcolor",function(){e.setColor(arguments[1]),s.hide()}),r.addListener("picknocolor",function(){e.setColor(""),s.hide()})},createTable:function(e,t){var i=[];if(i.push("<table id='J_example'>"),t&&i.push("<caption>"+lang.captionName+"</caption>"),e){i.push("<tr>");for(var n=0;5>n;n++)i.push("<th>"+lang.titleName+"</th>");i.push("</tr>")}for(var o=0;6>o;o++){i.push("<tr>");for(var a=0;5>a;a++)i.push("<td>"+lang.cellsName+"</td>");i.push("</tr>")}i.push("</table>"),r.innerHTML=i.join("")},titleHanler:function(){var i=$G("J_example"),n=document.createDocumentFragment(),o=domUtils.getComputedStyle(domUtils.getElementsByTagName(i,"td")[0],"border-color");if(t.checked){i.insertRow(0);for(var a,r=0;5>r;r++)a=document.createElement("th"),a.innerHTML=lang.titleName,n.appendChild(a);i.rows[0].appendChild(n)}else domUtils.remove(i.rows[0]);e.setColor(o)},captionHanler:function(){var e=$G("J_example");if(i.checked){var t=document.createElement("caption");t.innerHTML=lang.captionName,e.insertBefore(t,e.firstChild)}else domUtils.remove(domUtils.getElementsByTagName(e,"caption")[0])},autoSizeContentHanler:function(){var e=$G("J_example");e.removeAttribute("width")},autoSizePageHanler:function(){var e=$G("J_example"),t=e.getElementsByTagName(e,"td");utils.each(t,function(e){e.removeAttribute("width")}),e.setAttribute("width","100%")},getColor:function(){var e,t=editor.selection.getStart(),i=domUtils.findParentByTagName(t,["td","th","caption"],!0);return e=domUtils.getComputedStyle(i,"border-color"),e||(e="#DDDDDD"),e},setColor:function(e){var t=$G("J_example"),i=domUtils.getElementsByTagName(t,"td").concat(domUtils.getElementsByTagName(t,"th"),domUtils.getElementsByTagName(t,"caption"));a.value=e,utils.each(i,function(t){t.style.borderColor=e})},setAutoSize:function(){var e=this,t=editor.selection.getStart(),i=domUtils.findParentByTagName(t,"table",!0).width,a=!i;a?(n.checked=a,e.autoSizeContentHanler()):(o.checked=!a,e.autoSizePageHanler())}},new s,dialog.onok=function(){editor.__hasEnterExecCommand=!0,t.checked?-1!=editor.queryCommandState("inserttitle")&&editor.execCommand("inserttitle"):-1!=editor.queryCommandState("deletetitle")&&editor.execCommand("deletetitle"),i.checked?-1!=editor.queryCommandState("insertcaption")&&editor.execCommand("insertcaption"):-1!=editor.queryCommandState("deletecaption")&&editor.execCommand("deletecaption"),editor.execCommand("edittable",a.value),n.checked?editor.execCommand("adaptbytext"):"",o.checked?editor.execCommand("adaptbywindow"):"",editor.__hasEnterExecCommand=!1}})();