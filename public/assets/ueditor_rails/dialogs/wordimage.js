function hideFlash(){flashObj=null,flashContainer.innerHTML=""}function addOkListener(){dialog.onok=function(){if(imageUrls.length){for(var e,t=domUtils.getElementsByTagName(editor.document,"img"),i=0;e=t[i++];){var n=e.getAttribute("word_img");if(n)for(var o,a=0;o=imageUrls[a++];)if(-1!=n.indexOf(o.original.replace(" ",""))){e.src=editor.options.wordImagePath+o.url,e.setAttribute("data_ue_src",editor.options.wordImagePath+o.url),e.setAttribute("title",o.title),parent.baidu.editor.dom.domUtils.removeAttributes(e,["word_img","style","width","height"]),editor.fireEvent("selectionchange");break}}hideFlash()}},dialog.oncancel=function(){hideFlash()}}function addUploadListener(){g("upload").onclick=function(){flashObj.upload(),this.style.display="none"}}function showLocalPath(e){var t=editor.selection.getRange().getClosedNode();if(1==editor.word_img.length||t&&"IMG"==t.tagName)return g(e).value=editor.word_img[0],void 0;var i=editor.word_img[0],n=i.lastIndexOf("/")||0,o=i.lastIndexOf("\\")||0,a=n>o?"/":"\\";i=i.substring(0,i.lastIndexOf(a)+1),g(e).value=i}function createFlashUploader(e,t){var i=utils.extend({},lang.flashI18n);for(var n in i)n in{lang:1,uploadingTF:1,imageTF:1,textEncoding:1}||!i[n]||(i[n]=encodeURIComponent(editor.options.langPath+editor.options.lang+"/images/"+i[n]));e=utils.extend(e,i,!1);var o={createOptions:{id:"flash",url:e.flashUrl,width:e.width,height:e.height,errorMessage:lang.flashError,wmode:browser.safari?"transparent":"window",ver:"10.0.0",vars:e,container:e.container}};o=extendProperty(t,o),flashObj=new baidu.flash.imageUploader(o),flashContainer=$G(e.container)}function extendProperty(e,t){for(var i in e)t[i]||(t[i]=e[i]);return t}function getPasteData(e){return baidu.g("msg").innerHTML=lang.copySuccess+"</br>",setTimeout(function(){baidu.g("msg").innerHTML=""},5e3),baidu.g(e).value}function createCopyButton(e,t){baidu.swf.create({id:"copyFlash",url:"fClipboard_ueditor.swf",width:"58",height:"25",errorMessage:"",bgColor:"#CBCBCB",wmode:"transparent",ver:"10.0.0",vars:{tid:t}},e);var i=baidu.swf.getMovie("copyFlash"),n=setInterval(function(){i&&i.flashInit&&(clearInterval(n),i.setHandCursor(!0),i.setContentFuncName("getPasteData"))},500)}var wordImage={},g=baidu.g,flashObj,flashContainer;wordImage.init=function(e,t){showLocalPath("localPath"),createFlashUploader(e,t),addUploadListener(),addOkListener()},createCopyButton("clipboard","localPath");